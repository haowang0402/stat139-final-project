---
title: "EDA Part 2 Feiyang Huang"
output: html_document
date: "2022-11-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preprocessing of data: Categorical or Numerical

## 1, MonthDayHour (Dean)

Since the data comes solely from the span of two months, it makes sense to simply use the first day of Nov. as the baseline and the days as numerical in the range [1,61] and simply ignore the month column.

```{r cars}
rides = read.csv("sampled_rideshare.csv")
n_sample = dim(rides)
for(i in 1:50000){
  if(rides[i,"month"] == "12"){
    rides[i,"day"] = rides[i,"day"] + 30
  }
}
```

For the hours columns, it makes sense to create another categorical variable that divides the hours into different periods of the day

```{r}
tmp = rep(0,50000)
for(i in 1:50000){
  if((rides[i,"hour"] > 6) && (rides[i,"hour"] <= 12)){
    tmp[i]="morning"
  }
  if((rides[i,"hour"] > 12) && (rides[i,"hour"] <= 18)){
    tmp[i]="afternoon"
  }
  if((rides[i,"hour"] > 18) && (rides[i,"hour"] <= 23)){
    tmp[i]="evening"
  }
  if((rides[i,"hour"] >= 0) && (rides[i,"hour"] <= 6)){
    tmp[i]="midnight"
  }
}
rides$period_of_day = tmp
barplot(prop.table(table(rides$period_of_day)))
library("ggpubr")
ggboxplot(rides, x = "period_of_day", y = "price", 
          color = "period_of_day",
        ylab = "price", xlab = "period_of_day")
```

And we see from the plot that the proportion is close to being even among the categories, which also justifies our categorization choice.

```{r}
morning_data = na.omit(rides$price[(rides$period_of_day == "morning")])
afternoon_data = na.omit(rides$price[(rides$period_of_day == "afternoon")])
evening_data = na.omit(rides$price[(rides$period_of_day == "evening")])
midnight_data = na.omit(rides$price[(rides$period_of_day == "midnight")])
mean_morning = mean(na.omit(rides$price[(rides$period_of_day == "morning")]))
mean_afternoon = mean(na.omit(rides$price[(rides$period_of_day == "afternoon")]))
mean_evening = mean(na.omit(rides$price[(rides$period_of_day == "evening")]))
mean_midnight = mean(na.omit(rides$price[(rides$period_of_day == "midnight")]))

mean_df = data.frame(morning = mean_morning,
                     afternoon = mean_afternoon,
                     evening = mean_evening,
                     midnight = mean_midnight)

# Pairwise t-test for the means
t.test(morning_data, afternoon_data)
t.test(morning_data, evening_data)
t.test(morning_data, midnight_data)
t.test(afternoon_data, evening_data)
t.test(afternoon_data, midnight_data)
t.test(evening_data, midnight_data)
res.ftest <- anova(price ~ period_of_day, data = rides)
```
